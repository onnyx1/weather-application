(()=>{const e=document.querySelector("main"),t=document.querySelector(".header__search"),n=document.querySelector(".header__searchButton"),a=document.querySelector(".header__tempButton"),r={currentWeather:null,forecastWeather:null,hourlyWeather:null,imperial:!0,loadJson:e=>(document.querySelector(".loader").style.display="block",fetch(e).then((e=>{if(console.log(e.ok),e.ok)return e.json();throw new Error}))),init(){n.addEventListener("click",r.grabWeather),a.addEventListener("click",r.changeUnits),t.addEventListener("keyup",(e=>{13===e.keyCode&&(e.preventDefault(),n.click())})),r.loadJson("https://api.openweathermap.org/data/2.5/weather?q=Fairbanks&APPID=c31a4ec530e3f92cc56e0267f1d0a374&units=imperial").then((e=>(r.currentWeather=e,r.loadJson("https://api.openweathermap.org/data/2.5/forecast/daily?q=Fairbanks&APPID=0d5f22678e05d6d4aad7d8ee355979cf&units=imperial")))).then((e=>(r.forecastData=e,r.loadJson("https://pro.openweathermap.org/data/2.5/forecast/hourly?q=Fairbanks&cnt=24&APPID=0d5f22678e05d6d4aad7d8ee355979cf&units=imperial")))).then((e=>{r.hourlyWeather=e,r.showWeather()})).finally((()=>{document.querySelector(".loader").style.display="none"})).catch((()=>alert("Please enter a valid city.")))},grabWeather(){r.imperial?r.loadJson(`https://api.openweathermap.org/data/2.5/weather?q=${t.value}&APPID=c31a4ec530e3f92cc56e0267f1d0a374&units=imperial`).then((e=>(r.currentWeather=e,r.loadJson(`https://api.openweathermap.org/data/2.5/forecast/daily?q=${t.value}&APPID=0d5f22678e05d6d4aad7d8ee355979cf&units=imperial`)))).then((e=>(r.forecastData=e,r.loadJson(`https://pro.openweathermap.org/data/2.5/forecast/hourly?q=${t.value}&cnt=24&APPID=0d5f22678e05d6d4aad7d8ee355979cf&units=imperial`)))).then((e=>{r.hourlyWeather=e,r.showWeather()})).finally((()=>{document.querySelector(".loader").style.display="none"})).catch((()=>alert("Please enter a valid city."))):r.loadJson(`https://api.openweathermap.org/data/2.5/weather?q=${t.value}&APPID=c31a4ec530e3f92cc56e0267f1d0a374&units=metric`).then((e=>(r.currentWeather=e,r.loadJson(`https://api.openweathermap.org/data/2.5/forecast/daily?q=${t.value}&APPID=0d5f22678e05d6d4aad7d8ee355979cf&units=metric`)))).then((e=>(r.forecastData=e,r.loadJson(`https://pro.openweathermap.org/data/2.5/forecast/hourly?q=${t.value}&cnt=24&APPID=0d5f22678e05d6d4aad7d8ee355979cf&units=metric`)))).then((e=>{r.hourlyWeather=e,r.showWeather()})).finally((()=>{document.querySelector(".loader").style.display="none"})).catch((()=>alert("Please enter a valid city.")))},showWeather(){console.log("Hola"),r.clear();const t=`<article class="article">\n    <div class="article__row">\n      <article class="title-card-section">\n        <article class="title-card">\n          <h1 class="title-card__city">${this.currentWeather.name}</h1>\n          <div class="title-card__description">${this.currentWeather.weather[0].main}</div>\n          <div class="title-card__temp">${Math.round(this.currentWeather.main.temp)}&#176;</div>\n          <div class="title-card__temps"><span>H:<span class = "title-card__max">${Math.round(r.forecastData.list[0].temp.max)}</span>&#176; L:<span class="title-card__min">${Math.round(r.forecastData.list[0].temp.min)}</span>&#176;</div>\n        </article>\n      </article>\n\n      <section class="hourly-forecast-section">\n      </section>\n    </div>\n    <p class="title-card-summary">Today: ${r.currentWeather.weather[0].description}. The high will be <span class = "title-card-summary__maxTemp">${Math.round(r.forecastData.list[0].temp.max)}</span>°. The low tonight will be  <span class = "title-card-summary__minTemp">${Math.round(r.forecastData.list[0].temp.min)}</span>°.</p>\n  </article>\n\n  <section class="description-section">\n    <section class="description-section__column">\n      <div class="description-card">\n        <div class="description-card__title">Sunrise</div>\n        <div class="description-card__data">${new Date(1e3*r.currentWeather.sys.sunrise).toLocaleTimeString()}</div>\n      </div>\n      <div class="description-card">\n        <div class="description-card__title">Feels Like</div>\n        <div class="description-card__data description-card__data__feelsLike">${Math.round(r.currentWeather.main.feels_like)}&#176;</div>\n      </div>\n    </section>\n    <section class="description-section__column">\n      <div class="description-card">\n        <div class="description-card__title">Sunset</div>\n        <div class="description-card__data">${new Date(1e3*r.currentWeather.sys.sunset).toLocaleTimeString()}</div>\n      </div>\n      <div class="description-card">\n        <div class="description-card__title">Wind Speed</div>\n        <div class="description-card__data">${Math.round(r.currentWeather.wind.speed)} mph</div>\n      </div>\n    </section>\n    <section class="description-section__column">\n      <div class="description-card">\n        <div class="description-card__title">Chance of Rain</div>\n        <div class="description-card__data">${Math.round(100*r.forecastData.list[0].pop)}%</div>\n      </div>\n      <div class="description-card">\n        <div class="description-card__title">Pressure</div>\n        <div class="description-card__data">${r.currentWeather.main.pressure} hPa</div>\n      </div>\n    </section>\n    <section class="description-section__column">\n      <div class="description-card">\n        <div class="description-card__title">Humidity</div>\n        <div class="description-card__data">${Math.round(r.forecastData.list[0].humidity)}%</div>\n      </div>\n      <div class="description-card">\n        <div class="description-card__title">Visibility</div>\n        <div class="description-card__data">${r.currentWeather.visibility} m</div>\n      </div>\n    </section>\n    <section class="description-section__column">\n      <div class="description-card">\n        <div class="description-card__title">Latitude</div>\n        <div class="description-card__data">${r.currentWeather.coord.lat}&#176;</div>\n      </div>\n      <div class="description-card">\n        <div class="description-card__title">Longitude</div>\n        <div class="description-card__data">${r.currentWeather.coord.lon}&#176;</div>\n      </div>\n    </section>\n  </section>\n\n  <section class="table-container">\n    <table class="table">\n      <tr>\n        <th class="table__header">DAY</th>\n        <th></th>\n        <th class="table__header">CHANCE OF RAIN</th>\n        <th class="table__header">HUMIDITY</th>\n        <th class="table__header">TEMPERATURE</th>\n      </tr>\n    </table>\n  </section>`;e.appendChild(document.createRange().createContextualFragment(t)),this.showTable(),this.showHourly()},clear(){e.innerHTML=""},showTable(){const e=document.querySelector(".table"),t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(const n of r.forecastData.list){const a=e.insertRow(-1),r=a.insertCell(0),c=a.insertCell(1),o=a.insertCell(2),i=a.insertCell(3),d=a.insertCell(4);r.innerText=t[new Date(1e3*n.dt).getUTCDay()],c.innerHTML=`<img src="http://openweathermap.org/img/wn/${n.weather[0].icon}@2x.png" alt="" />`,o.innerText=`${Math.round(100*n.pop)}%`,i.innerText=`${Math.round(n.humidity)}%`,d.innerHTML=`<span class = "space cell_max">${Math.round(n.temp.max)}&#176;</span><span class = "cell_min">${Math.round(n.temp.min)}&#176;</span>`}},showHourly(){const e=document.querySelector(".hourly-forecast-section");let t="";for(const e of r.hourlyWeather.list)t+=`<section class="hourly-forecast-card">\n          <div class="hourly-forecast-card__time">${new Date(1e3*e.dt).getHours()}</div>\n          <div class="hourly-forecast-card__precip">${Math.round(100*e.pop)}%</div>\n          <img class="hourly-forecast-card__image" src="http://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png" alt="" />\n          <div class="hourly-forecast-card__temp">${Math.round(e.main.temp)}&#176;</div>\n        </section>`;e.appendChild(document.createRange().createContextualFragment(t))},changeUnits(){if(document.querySelector(".header__tempButton__F").classList.toggle("header__tempButton__F--bold"),document.querySelector(".header__tempButton__C").classList.toggle("header__tempButton__C--bold"),r.imperial){r.imperial=!1;const e=document.querySelectorAll(".hourly-forecast-card__temp");for(const t of e)t.textContent=t.textContent.replace("°",""),t.textContent=Math.round(10*r.fToC(Number(t.textContent)))/10+"°";document.querySelector(".title-card__temp").textContent=document.querySelector(".title-card__temp").textContent.replace("°",""),document.querySelector(".title-card__temp").textContent=Math.round(10*r.fToC(Number(document.querySelector(".title-card__temp").textContent)))/10+"°",document.querySelector(".title-card__max").textContent=""+Math.round(10*r.fToC(Number(document.querySelector(".title-card__max").textContent)))/10,document.querySelector(".title-card__min").textContent=""+Math.round(10*r.fToC(Number(document.querySelector(".title-card__min").textContent)))/10,document.querySelector(".title-card-summary__maxTemp").textContent=document.querySelector(".title-card__max").textContent,document.querySelector(".title-card-summary__minTemp").textContent=document.querySelector(".title-card__min").textContent,document.querySelector(".description-card__data__feelsLike").textContent=document.querySelector(".description-card__data__feelsLike").textContent.replace("°",""),document.querySelector(".description-card__data__feelsLike").textContent=Math.round(10*r.fToC(Number(document.querySelector(".description-card__data__feelsLike").textContent)))/10+"°";for(const e of document.querySelectorAll(".cell_max"))e.textContent=e.textContent.replace("°",""),e.textContent=Math.round(10*r.fToC(Number(e.textContent)))/10+"°";for(const e of document.querySelectorAll(".cell_min"))e.textContent=e.textContent.replace("°",""),e.textContent=Math.round(10*r.fToC(Number(e.textContent)))/10+"°"}else{r.imperial=!0;const e=document.querySelectorAll(".hourly-forecast-card__temp");for(const t of e)t.textContent=t.textContent.replace("°",""),t.textContent=`${Math.round(r.cToF(Number(t.textContent)))}°`;document.querySelector(".title-card__temp").textContent=document.querySelector(".title-card__temp").textContent.replace("°",""),document.querySelector(".title-card__temp").textContent=`${Math.round(r.cToF(Number(document.querySelector(".title-card__temp").textContent)))}°`,document.querySelector(".title-card__max").textContent=`${Math.round(r.cToF(Number(document.querySelector(".title-card__max").textContent)))}`,document.querySelector(".title-card__min").textContent=`${Math.round(r.cToF(Number(document.querySelector(".title-card__min").textContent)))}`,document.querySelector(".title-card-summary__maxTemp").textContent=document.querySelector(".title-card__max").textContent,document.querySelector(".title-card-summary__minTemp").textContent=document.querySelector(".title-card__min").textContent,document.querySelector(".description-card__data__feelsLike").textContent=document.querySelector(".description-card__data__feelsLike").textContent.replace("°",""),document.querySelector(".description-card__data__feelsLike").textContent=`${Math.round(r.cToF(Number(document.querySelector(".description-card__data__feelsLike").textContent)))}°`;for(const e of document.querySelectorAll(".cell_max"))e.textContent=e.textContent.replace("°",""),e.textContent=`${Math.round(r.cToF(Number(e.textContent)))}°`;for(const e of document.querySelectorAll(".cell_min"))e.textContent=e.textContent.replace("°",""),e.textContent=`${Math.round(r.cToF(Number(e.textContent)))}°`}},fToC:e=>5*(e-32)/9,cToF:e=>9*e/5+32};r.init()})();